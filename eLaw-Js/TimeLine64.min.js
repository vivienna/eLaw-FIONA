function initTimeLine(e, t, n) {var timer = setTimeout(sliderTimer, 2E3); function u(e) {clearTimeout(timer); $(".TLscrollLine").slideDown("fast"); $(".MainTimeLine").css("left", "-" + $(".TLscrollLine").slider("value") + "px"); $(".lborder").css("left", $(".TLscrollLine").slider("value") + "px"); $(".rborder").css("right", -$(".TLscrollLine").slider("value") + "px"); if ($(".TLscrollLine").slider("value") == 0) $(".arrowLeft").addClass("disabledArrow", function () { $(this).css("opacity", "0.2") }); else if ($(".arrowLeft").is(".disabledArrow")) $(".arrowLeft").removeClass("disabledArrow",function () { $(this).css("opacity", "0.8") }); if ($(".TLscrollLine").slider("value") == s) $(".arrowRight").addClass("disabledArrow", function () { $(this).css("opacity", "0.2") }); else if ($(".arrowRight").is(".disabledArrow")) $(".arrowRight").removeClass("disabledArrow", function () { $(this).css("opacity", "0.8") }); timer = setTimeout(sliderTimer, 2E3); timer} function sliderTimer() { $(".TLscrollLine").slideUp("slow") } var r; $(".timeLine").append('<div class="MainTLFrame"></div>'); $(".MainTLFrame").css("width", $(".MainTLFrame").parent().width() -100 + "px"); $(".MainTLFrame").append('<div class="MainTimeLine"></div>'); $(".MainTimeLine").append('<div class="TLLine" style="width:' + ((e.length - 1) * 150 + 200) + 'px"></div>'); for (var i in e) {$(".MainTimeLine").append('<div class="TLTitle" idx="' + i + '" style="left:' + (i * 150 + 60) + 'px">' + e[i][0].toUpperCase() + "</div>"); $('.TLTitle[idx="' + i + '"]').css("left", "-=" + $('.TLTitle[idx="' + i + '"]').width() / 2 + "px"); $(".MainTimeLine").append('<div class="TLDate" idx="' + i + '" style="left:' + (i * 150 + 60) + 'px">(' + e[i][1] + ")</div>");$('.TLDate[idx="' + i + '"]').css("left", "-=" + $('.TLDate[idx="' + i + '"]').width() / 2 + "px"); $(".MainTimeLine").append('<div class="TLCircle" idx="' + i + '" style="left:' + (i * 150 + 50) + 'px"></div>'); $(".MainTimeLine").append('<div class="TLpop" idx="' + i + '" style="left:' + (i * 150 + 53) + 'px">' + e[i][2] + "</div>"); $(".MainTimeLine").append('<div class="TLNodeBox" idx="' + i + '" style="left:' + (i * 150 + 60 - $('.TLTitle[idx="' + i + '"]').width() / 2 - 11) + "px;width:" + ($('.TLTitle[idx="' + i + '"]').width() + 20) + 'px;display:none;"></div>'); $(".MainTimeLine").append('<div class="nodeBoxArrow" idx="' +i + '" style="left:' + (i * 150 + 60 - 11) + 'px;display:none;"></div>'); if (i != 0) $('.TLpop[idx="' + i + '"]').css("left", "-=" + $('.TLpop[idx="' + i + '"]').width() / 2 + "px")} $(".TLpop:last").css("left", "-=" + $(".TLpop:last").width() / 2 + "px"); r = $(".TLLine").width(); var s; var o = false; $(".timeLine").css({ height: "100px", "padding-top": "5px", "margin-bottom": "-30px" }); $(".MainTimeLine").append('<div class="rborder"></div><div class="lborder"></div>'); if (r > $(".timeLine").width()) { $(".rborder").css("right", "0px"); $(".MainTLFrame").before('<img class="arrowLeft disabledArrow" src="img/arrowLeft.png"/>');$(".timeLine").append('<img class="arrowRight" src="img/arrowLeft.png"/>'); s = r - $(".timeLine").width(); $(".timeLine").append('<div class="TLscrollLine"></div>'); $(".TLscrollLine").slider({ orientation: "horizontal", range: "min", max: s, value: 0, slide: u, change: u }); $(".ui-slider-range-min").removeClass("ui-slider-range").removeClass("ui-widget-header"); $(".timeLine").css({ overflow: "hidden" })} else {$(".MainTimeLine").css("left", "50%"); $(".MainTimeLine").css("margin-left", "-=" + (r / 2 - 40) + "px"); $(".TLLine").width($(".TLLine").width() -80 + "px"); $(".rborder").css("left", "" + $(".TLLine").width() + "px")} if (n != undefined) $('.TLCircle[idx="' + n + '"]').stop(true, true).animate({ height: "16px", width: "16px", left: "-=3px", top: "-=3px", "border-color": "#900", "background-color": "#f00" }, 400, "easeOutBounce"); $(".TLscrollLine .ui-slider-handle,.TLscrollLine ").removeClass("ui-corner-all"); $(".TLscrollLine").hide(); $(".TLCircle,.TLTitle,.TLDate").hover(function () {if (n != $(this).attr("idx")) $('.TLCircle[idx="' + $(this).attr("idx") + '"]').stop(true, true).animate({ "height": "16px","width": "16px", "left": "-=3px", "top": "-=3px", "border-color": "#900", "background-color": "#f00"}, 400, "easeOutBounce"); $('.TLpop[idx!="' + $(this).attr("idx") + '"]').stop(true, true).css("z-index", "1").slideUp(100); $('.TLpop[idx="' + $(this).attr("idx") + '"]').stop(true, true).css("z-index", "3").slideDown("fast"); $('.TLNodeBox[idx="' + $(this).attr("idx") + '"],.nodeBoxArrow[idx="' + $(this).attr("idx") + '"]').stop(true, true).fadeIn("slow")}, function () {if (n != $(this).attr("idx")) $('.TLCircle[idx="' + $(this).attr("idx") +'"]').stop(true, true).animate({ "height": "10px", "width": "10px", "left": "+=3px", "top": "+=3px", "border-color": "#888", "background-color": "#888" }, 400, "easeOutBounce"); $('.TLpop[idx="' + $(this).attr("idx") + '"]').stop(true, true).css("z-index", "1").delay(500).slideUp("slow"); $('.TLNodeBox[idx="' + $(this).attr("idx") + '"],.nodeBoxArrow[idx="' + $(this).attr("idx") + '"]').stop(true, true).fadeOut("slow")}); $(".TLCircle").click(function () { t($(this).attr("idx")) }); $(".TLDate,.TLTitle").click(function () {var e = $(this).attr("idx");$(this).parent().children('.TLCircle[idx="' + e + '"]').click()}); $(".arrowLeft").mousedown(function () { $(".arrowRight").removeClass("disabledArrow"); if ($(".TLscrollLine").slider("value") >= 100) $(".TLscrollLine").slider("value", $(".TLscrollLine").slider("value") - 100); else if ($(".TLscrollLine").slider("value") > 0) $(".TLscrollLine").slider("value", 0) }); $(".arrowRight").mousedown(function () {$(".arrowLeft").removeClass("disabledArrow"); if ($(".TLscrollLine").slider("value") <= s - 100) $(".TLscrollLine").slider("value",$(".TLscrollLine").slider("value") + 100); else if ($(".TLscrollLine").slider("value") < s) $(".TLscrollLine").slider("value", s)}); $(".arrowRight,.arrowLeft").hover(function () { if (!$(this).is(".disabledArrow")) $(this).css("opacity", 1) }, function () { if (!$(this).is(".disabledArrow")) $(this).css("opacity", 0.8) }); $(window).on("resize", function () { $(".timeLine").html(""); initTimeLine(e, t, n) })};